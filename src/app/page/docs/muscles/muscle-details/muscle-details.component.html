<div class="container">
  <app-loading [loading]="loading()"/>
  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
      <h2 class="mb-2">{{ muscle()?.name }}</h2>
      <div *ngIf="isAdmin" class="mb-2 d-flex flex-wrap align-items-center">
        <app-modal-button
          (onCLickModalButton)="onModify()"
          [modalId]="muscleModalId"
          btnClass="btn-outline-warning btn-sm me-2"
        >
          Modify
          <i class="fa-solid fa-pen-to-square"></i>
        </app-modal-button>
        <app-modal-button
          (onCLickModalButton)="onDelete()"
          [modalId]="muscleModalId"
          btnClass="btn-outline-danger btn-sm me-2"
        >
          Delete
          <i class="fa-solid fa-trash"></i>
        </app-modal-button>
        <app-muscle-modal [action]="action()"
                          [modalTitle]="modalTitle()"
                          [muscleModalId]="muscleModalId"
                          [muscle]="muscle()"
        />
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-8">
        <h6 class="fw-bold text-dark mb-2">Description</h6>
        <p class="text-muted text-justify">
          {{ muscle()?.description }}
        </p>
      </div>
      <div class="col-md-4 text-center">
        @let localMuscle = muscle();
        @if (localMuscle) {
          @let image = `assets/muscle/${localMuscle.latinName.split(' ').join('-')}.png`;
          <img
            [ngSrc]="image"
            alt="Muscle illustration"
            class="img-fluid"
            [width]="200"
            [height]="200"
            style="object-fit: cover;"
          />
        }
      </div>
    </div>

    <div class="mb-4">
      <h6 class="fw-bold text-dark mb-2">Function</h6>
      <p class="text-muted text-justify">
        {{ muscle()?.function }}
      </p>
    </div>
    <hr/>

    <div class="mb-4">
      <h5 class="fw-bold mb-3">Exercices utilisant ce muscle</h5>
      <p *ngIf="!muscle()?.exercises?.length" class="text-muted fst-italic">
        Aucun exercice associ√© pour ce muscle.
      </p>
      <div *ngIf="muscle()?.exercises?.length">
        <div class="table-responsive">
          <table class="table table-sm table-hover">
            <thead class="text-muted">
            <tr>
              <th class="col-2" scope="col">Nom</th>
              <th class="col-5" scope="col">Objectif</th>
              <th class="col-5" scope="col">Description</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let exercise of muscle()?.exercises" class="table-row-clickable">
              <td class="position-relative">
                <a [routerLink]="['/exercises', exercise.id]" class="stretched-link text-body ">
                  {{ exercise.name }}
                </a>
              </td>
              <td class="text-truncate position-relative ">
                <a [routerLink]="['/exercises', exercise.id]" class="stretched-link text-body">
                  {{ exercise.goal }}
                </a>
              </td>
              <td class="text-truncate position-relative">
                <a [routerLink]="['/exercises', exercise.id]" class="stretched-link text-body">
                  {{ exercise.description }}
                </a>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
